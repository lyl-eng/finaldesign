# 多智能体模式使用指南

## 如何启用多智能体翻译模式

### 方法一：通过UI界面启用（推荐）

1. **打开AiNiee应用**
   - 启动程序后，进入主界面

2. **进入任务设置页面**
   - 在左侧导航栏找到 **"任务设置"** 选项
   - 点击进入任务设置页面

3. **启用多智能体模式**
   - 在任务设置页面顶部，你会看到 **"多智能体翻译模式"** 开关
   - 点击开关，将其切换到 **开启状态**（开关变为蓝色/绿色）
   - 系统会显示提示："多智能体模式已启用"

4. **开始翻译**
   - 返回主界面（"开始翻译"页面）
   - 加载你的源文件
   - 点击 **"开始翻译"** 按钮
   - 系统将自动使用多智能体工作流进行翻译

### 方法二：通过配置文件启用

如果你熟悉配置文件，也可以直接编辑配置文件：

1. **打开配置文件**
   - 找到 `Resource/config.json` 文件
   - 用文本编辑器打开

2. **添加配置项**
   ```json
   {
     "use_multi_agent_mode": true,
     "multi_agent": {
       "enable_human_intervention": true,
       "terminology_review_threshold": 10,
       "translation_review_threshold": 0.8
     }
   }
   ```

3. **保存并重启应用**

## 多智能体模式功能说明

启用多智能体模式后，翻译流程将包括以下阶段：

### 阶段1：译前预处理
- **文本结构拆解**：按段落、逻辑块、章节边界切分
- **语域风格识别**：自动判断领域（法律、文学、新闻等）和语体风格（正式、口语化等）

### 阶段2：术语识别与一致性保障
- **命名实体识别**：自动识别人名、地名、机构名等
- **领域术语识别**：识别专业词汇和短语
- **文化负载词识别**：识别缺乏直接对等表达的词汇
- **知识库查证**：使用LLM查证术语翻译
- **构建术语库**：确保全文术语翻译一致

### 阶段3：翻译执行与优化
- **多步骤翻译**：理解—分解—转换—润色
- **多版本生成**：生成直译版、意译版、风格化版
- **智能融合**：自动评选和融合最佳版本
- **回译验证**：回译验证翻译质量
- **自我修正**：发现问题自动修正

### 阶段4：人机协作（可选）
- **术语审核**：首次出现的术语需要人工确认
- **翻译审核**：质量评估低于阈值时人工审核

## 使用建议

### 适合使用多智能体模式的场景：
- ✅ 长文本翻译（书籍、长文档）
- ✅ 专业领域翻译（需要术语一致性）
- ✅ 文化负载词较多的文本
- ✅ 对翻译质量要求较高的场景

### 不适合使用多智能体模式的场景：
- ❌ 简单短文本翻译（会增加不必要的处理时间）
- ❌ 对速度要求极高的场景（多智能体模式较慢）
- ❌ API调用成本敏感的场景（会进行多次LLM调用）

## 注意事项

1. **性能影响**
   - 多智能体模式会进行多次LLM调用，执行时间可能比传统模式长2-3倍
   - 建议在翻译长文本时使用

2. **成本考虑**
   - 多版本生成和回译验证会增加API调用次数
   - 建议根据实际需求选择使用

3. **人工介入**
   - 系统会在关键节点提示人工审核
   - 建议对首次出现的术语进行人工确认，确保翻译准确性

4. **配置要求**
   - 确保已配置LLM API（支持OpenAI、Anthropic、Google等）
   - NER模型文件位于 `Resource/Models/ner/` 目录（用于命名实体识别）

## 切换回传统模式

如果需要切换回传统翻译模式：

1. 进入 **"任务设置"** 页面
2. 将 **"多智能体翻译模式"** 开关切换到 **关闭状态**
3. 系统会显示提示："多智能体模式已禁用"
4. 下次翻译时将使用传统模式

## 常见问题

### Q: 启用多智能体模式后，翻译速度变慢了？
A: 这是正常的。多智能体模式会进行多次LLM调用来确保质量，速度会比传统模式慢，但质量更高。

### Q: 如何知道当前使用的是哪种模式？
A: 在任务设置页面查看"多智能体翻译模式"开关的状态即可。

### Q: 多智能体模式支持哪些文件格式？
A: 支持所有传统模式支持的文件格式（EPUB、TXT、DOCX、SRT等）。

### Q: 可以中途切换模式吗？
A: 建议在开始翻译前确定使用哪种模式。如果已经开始翻译，需要先停止任务，切换模式后再重新开始。

## 技术支持

如果遇到问题，请检查：
1. 配置文件是否正确
2. LLM API配置是否有效
3. 日志输出中的错误信息

更多详细信息请参考 `ModuleFolders/MultiAgent/README.md`
